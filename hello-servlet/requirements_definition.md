# 会員登録画面の要件定義

## 1. **概要**

会員が新規登録できるWeb画面を提供し、入力された情報をバックエンドのServletで処理し、データベースに保存する。ユーザーが会員情報を用いてログインし、認証を行う機能を提供する。ログイン成功時には、ユーザーの情報をセッションに保存し、適切なページへリダイレクトする。

---

## 2. **機能要件**

### **2.1. フロントエンド**

- **会員情報入力項目**

| 登録内容 | 必須 | 備考 |
|---|---|---|
| ユーザーネーム | 必須 |  |
| メールアドレス | 必須 |  |
| パスワード | 必須 |  |
| 確認用パスワード | 必須 | パスワードとの一致チェック |

- **バリデーション**
  - 必須項目のチェック
  - メールアドレスの形式チェック (例: `test@example.com`)
  - パスワードと確認用パスワードが一致しているか

- **画面構成**
  - 会員情報入力画面
  - 入力内容確認画面
  - 会員情報登録完了画面
  - ログイン画面
  - メイン画面

- **画面ごとの要件**
  - **会員情報入力画面(`/index.jsp`)**
    - `会員情報入力項目`に沿って入力内容の入力が可能
    - `確認`ボタンを実装し、入力内容確認画面へ遷移する
    - 入力内容確認画面には、入力された情報をすべて渡す。但し、パスワードについてはマスク化などを行い、表示されない形式にする
  - **入力内容確認画面(`/confirm.jsp`)**
    - ユーザーが入力した情報を確認する画面を提供する。
    - 入力画面 (index.jsp) から確認画面(/confirm.jsp)への遷移時にセッションを利用してデータを保持する。
    - 確認画面では、パスワードは`●●●●●●`のように マスク表示 し、直接表示しない。
    - 「登録」ボタンを押すと、/RegisterServlet にPOSTリクエストを送信し、データベースへ保存する。
  - **会員情報登録完了画面(`/register.jsp`)**
    - セッションの情報を取得し、バリデーション後にデータベースへ登録する。
    - 登録成功時、セッションの会員情報を削除し、登録完了画面へリダイレクトする。
    - 登録失敗時、セッションの会員情報を削除し、会員情報入力画面へリダイレクトする。
  - **ログイン画面 (`/login.jsp`)**
    - ユーザーが以下の情報を入力し、ログインを行う。
      - メールアドレス（必須）
      - パスワード（必須、入力時にマスク表示）
      - パスワードの未入力チェック
      - 「ログイン」ボタンを押下すると、`/LoginServlet` にPOSTリクエストを送信する。

- **エラー時表示内容**
  - 会員情報入力画面(`/index.jsp`)
    - 未入力
      - "このフィールドを入力してください"
    - メールアドレス形式不一致
      - "メールアドレスに「@」を挿入してください"
    - パスワードと確認用パスワードの不一致
      - "入力されたパスワードが一致しません"
  - ログイン画面(`/login.jsp`)
    - ユーザーネーム未入力時
      - "このフィールドは必須項目です"
    - パスワード未入力時
      - "このフィールドは必須項目です"
    - ログイン失敗時
      - "ユーザーネームまたはパスワードが間違っています"

---

### **2.2. バックエンド (Servlet)**

- **画面遷移フロー(`/ConfirmServlet`)**
- **処理フロー(`/RegisterServlet`)**
  1. フロントエンドからPOSTリクエストを受信
  2. バリデーションチェック
  3. データベースへの登録
  4. レスポンスを返却（成功 or 失敗）
- **認証処理 (`/LoginServlet`)**
  1. フロントエンドから受け取ったメールアドレス・パスワードを取得
  2. データベースから該当するユーザー情報を検索
  3. 入力されたパスワードを **ハッシュ化されたパスワードと照合**
  4. 認証成功時：
     - ユーザー情報を **セッションに保存**
     - ホーム画面 (`/main.jsp`) へリダイレクト
  5. 認証失敗時：
     - エラーメッセージを表示
     - ログイン画面 (`/login.jsp`) に戻る

---

## 3. **非機能要件**

- **セキュリティ**
  - セッション管理
    - 画面遷移でパスワードを渡す場合は、マスク化して渡す
  - データ保護
    - パスワードは BCrypt でハッシュ化 し、平文を保存しない。
  - パスワードの取り扱い
    - パスワードはデータベースに **ハッシュ化（BCrypt）** して保存し、平文で保存しない
    - ログイン処理時に **ハッシュ化したパスワードと比較** して認証

---

以上が会員登録画面の要件定義です。

