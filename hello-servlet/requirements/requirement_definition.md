# 要件定義

## 1. 画面構成

|No|画面名|ファイル名(.jsp)|機能要件|
|-|-|-|-|
|1|会員情報入力画面|/index|ユーザーが自身の情報を入力し、送信することができる。|
|2|入力情報確認画面|/confirm|ユーザーの入力した内容を表示することができる。|
|3|会員情報登録完了画面|/register|ユーザー情報の登録の結果を表示する。成功していた場合、<br>ユーザーは画面内のボタンでログイン画面へ遷移することができる。|
|4|ログイン画面|/login|ユーザーは指定の情報を入力し、ログインすることができる。<br>ログインが成功した場合ユーザーは、自動でmain画面へ遷移することができる。|
|5|メイン画面|/main|ログインが成功した旨を表示する。|

## 2. ユーザー登録

### 機能要件

- ユーザーは情報を入力して会員情報を登録することができる。
- 海外のユーザーに対しては、姓と名を漢字またはカタカナでの入力を求める。
  - そのため、姓と名の入力最大文字数を20文字に設定する。

**入力項目**

|No|項目|必須|文字数|形式|備考|
|-|-|-|-|-|-|
|1|姓|必須|最大20文字|||
|2|名|必須|最大20文字|||
|3|メールアドレス|必須|最大255文字||すでに登録されている場合はエラーとする|
|4|パスワード|必須|8文字~32文字|半角英数字のみ||
|5|確認用パスワード|必須|8文字~32文字|半角英数字のみ||

### 非機能要件

- パスワードと確認用パスワードが一致しているかのバリデーションを行う。
- 以下の情報登録時にはリアルタイムのバリデーションを行う
- ユーザー登録時のパスワードはハッシュ化して保存する。
- パスワードのバリデーションの際に、特殊文字は考慮しないものとする。
 
## 3. ログイン機能

### 機能要件

- ユーザーは登録済みの以下の情報を使用してログインすることができる。
  - 姓名
  - パスワード
- ユーザーが入力した姓名と登録されているパスワードが一致した場合ログインが成功する
- エラーメッセージは「入力された姓・名またはパスワードが間違っています」とする。
- セキュリティ上問題内範囲でサーバー内に情報を保存し、複数ページにわたってログイン状態を維持する。詳細は`設計`を参照。


### 非機能要件

- ログイン認証機能では、入力されたパスワードとハッシュ化されているパスワードを比較する。
- セッションには平文のパスワードを保持せず、ユーザーIDまたはトークンのみを保持する。

## 4. 入力バリデーション

- 姓・名の入力は日本語（漢字・ひらがな・カタカナ）のみ許容する。
- メールアドレスが指定の形式になっているのかを確認する
  - 指定の形式：`自由記述 + @ + ドメイン`

## 5. セキュリティ対策

- ログイン失敗時のエラーメッセージは、アカウントの有無が判別できないよう統一する。
- パスワード入力欄では、入力内容をマスク表示し、確認画面にはパスワードを表示しない。
- 同時に複数のユーザーが登録を行う際の競合を防ぎ、一貫したデータ管理を実現します。
- 多重送信（ボタン連打）による二重登録を防ぐため、登録完了までの間にボタンを無効化する。

## 6. 重複登録防止

- 同一のメールアドレスでの登録を許可しない。
- すでに登録されているメールアドレスで新規登録を試みた場合、エラーメッセージを表示する。
  - エラーメッセージ："そのメールアドレスはすでに使用されています"  
- 同時に複数のユーザーが登録を行う際の競合を防ぎ、一貫したデータ管理を実現します。

## 7. UX向上

- 今回は入力内容が比較的少ないため、リアルタイムバリデーションは行わない。
